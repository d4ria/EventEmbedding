schema: '2.0'
stages:
  preprocess_data:
    cmd: python -m scripts.preprocess_data
    deps:
    - path: scripts/preprocess_data.py
      md5: ff6d83f4a84dd6e325e8088b22366c80
      size: 349
    params:
      params.yaml:
        datapath: data/comments.csv
        timedelta: h
    outs:
    - path: data/preprocessed_dataframe.pkl
      md5: 98e64bc7c87a1c9128b5e1bc2e795bdd
      size: 7182517
  calculate_event_graph_weights:
    cmd: python -m scripts.create_event_graph
    deps:
    - path: data/preprocessed_dataframe.pkl
      md5: 98e64bc7c87a1c9128b5e1bc2e795bdd
      size: 7182517
    - path: scripts/create_event_graph.py
      md5: 122ef8c084ae0e647ca2cfa5723b8e08
      size: 813
    params:
      params.yaml:
        data_ratio: 0.15
        timedelta: h
    outs:
    - path: data/event_to_nodes.pkl
      md5: b9ed95ea1eda502c96ef170af4884b70
      size: 2316289
    - path: data/w_co_dict.pkl
      md5: 66b5e06ec1c455f15d2af5756fc911e1
      size: 11969426
    - path: data/w_path_dict.pkl
      md5: e7d347a6e6c3c9e4cb8418d4af1d01eb
      size: 36074151
  sample_neighbourhoods:
    cmd: python -m scripts.sample_neighbourhoods
    deps:
    - path: data/event_to_nodes.pkl
      md5: b9ed95ea1eda502c96ef170af4884b70
      size: 2316289
    - path: data/w_co_dict.pkl
      md5: 66b5e06ec1c455f15d2af5756fc911e1
      size: 11969426
    - path: data/w_path_dict.pkl
      md5: e7d347a6e6c3c9e4cb8418d4af1d01eb
      size: 36074151
    - path: scripts/sample_neighbourhoods.py
      md5: 19410dd274e11c012d415dcbf0fd4215
      size: 816
    params:
      params.yaml:
        sampling.alpha: 0.5
        sampling.nb: 10
        sampling.s: 10
    outs:
    - path: data/sampled_neighbourhoods.pkl
      md5: 40a647196212a615f08617375b9c0868
      size: 107133656
  apply_skipgram:
    cmd: python -m scripts.apply_skipgram
    deps:
    - path: data/sampled_neighbourhoods.pkl
      md5: 40a647196212a615f08617375b9c0868
      size: 107133656
    params:
      params.yaml:
        skipgram.epochs: 20
        skipgram.min_count: 25
        skipgram.vector_size: 30
        skipgram.window: 10
    outs:
    - path: data/embeddings.pkl
      md5: bac1823c2a005fcd6830e456375a8b2a
      size: 8420996
  visualize:
    cmd: python -m scripts.visualize
    deps:
    - path: data/embeddings.pkl
      md5: bac1823c2a005fcd6830e456375a8b2a
      size: 8420996
